(function(){var e,t,n,o,i,r,s,a,u,l,c,d,f=[].slice,m=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},h={}.hasOwnProperty,p=function(e,t){function n(){this.constructor=e}for(var o in t)h.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},g=function(e,t){return function(){return e.apply(t,arguments)}};n={bind:function(e,t){var n,o,i,r,s;for(o=e.split(" "),n=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={}),r=0,s=o.length;r<s;r++)i=o[r],n[i]||(n[i]=[]),n[i].push(t);return this},one:function(e,t){return this.bind(e,function(){return this.unbind(e,arguments.callee),t.apply(this,arguments)})},trigger:function(){var e,t,n,o,i,r,s;if(e=1<=arguments.length?f.call(arguments,0):[],n=e.shift(),o=this.hasOwnProperty("_callbacks")&&(null!=(s=this._callbacks)?s[n]:void 0)){for(i=0,r=o.length;i<r&&(t=o[i],t.apply(this,e)!==!1);i++);return!0}},unbind:function(e,t){var n,o,i,r,s,a;if(!e)return this._callbacks={},this;if(i=null!=(a=this._callbacks)?a[e]:void 0,!i)return this;if(!t)return delete this._callbacks[e],this;for(o=r=0,s=i.length;r<s;o=++r)if(n=i[o],n===t){i=i.slice(),i.splice(o,1),this._callbacks[e]=i;break}return this}},o={trace:!0,logPrefix:"(App)",log:function(){var e;if(e=1<=arguments.length?f.call(arguments,0):[],this.trace)return this.logPrefix&&e.unshift(this.logPrefix),"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,e),this}},d=["included","extended"],r=function(){function e(){"function"==typeof this.init&&this.init.apply(this,arguments)}return e.include=function(e){var t,n,o;if(!e)throw new Error("include(obj) requires obj");for(t in e)n=e[t],m.call(d,t)<0&&(this.prototype[t]=n);return null!=(o=e.included)&&o.apply(this),this},e.extend=function(e){var t,n,o;if(!e)throw new Error("extend(obj) requires obj");for(t in e)n=e[t],m.call(d,t)<0&&(this[t]=n);return null!=(o=e.extended)&&o.apply(this),this},e.proxy=function(e){var t=this;return function(){return e.apply(t,arguments)}},e.prototype.proxy=function(e){var t=this;return function(){return e.apply(t,arguments)}},e}(),i=function(t){function o(e){o.__super__.constructor.apply(this,arguments),e&&this.load(e),this.cid=this.constructor.uid("c-")}return p(o,t),o.extend(n),o.records={},o.crecords={},o.attributes=[],o.configure=function(){var e,t;return t=arguments[0],e=2<=arguments.length?f.call(arguments,1):[],this.className=t,this.records={},this.crecords={},e.length&&(this.attributes=e),this.attributes&&(this.attributes=c(this.attributes)),this.attributes||(this.attributes=[]),this.unbind(),this},o.toString=function(){return""+this.className+"("+this.attributes.join(", ")+")"},o.find=function(e){var t;if(t=this.records[e],!t&&(""+e).match(/c-\d+/))return this.findCID(e);if(!t)throw new Error("Unknown record");return t.clone()},o.findCID=function(e){var t;if(t=this.crecords[e],!t)throw new Error("Unknown record");return t.clone()},o.exists=function(e){try{return this.find(e)}catch(t){return!1}},o.refresh=function(e,t){var n,o,i,r;for(null==t&&(t={}),t.clear&&(this.records={},this.crecords={}),o=this.fromJSON(e),u(o)||(o=[o]),i=0,r=o.length;i<r;i++)n=o[i],n.id||(n.id=n.cid),this.records[n.id]=n,this.crecords[n.cid]=n;return this.trigger("refresh",this.cloneArray(o)),this},o.select=function(e){var t,n,o;return o=function(){var o,i;o=this.records,i=[];for(t in o)n=o[t],e(n)&&i.push(n);return i}.call(this),this.cloneArray(o)},o.findByAttribute=function(e,t){var n,o,i;i=this.records;for(n in i)if(o=i[n],o[e]===t)return o.clone();return null},o.findAllByAttribute=function(e,t){return this.select(function(n){return n[e]===t})},o.each=function(e){var t,n,o,i;o=this.records,i=[];for(t in o)n=o[t],i.push(e(n.clone()));return i},o.all=function(){return this.cloneArray(this.recordsValues())},o.first=function(){var e;return e=this.recordsValues()[0],null!=e?e.clone():void 0},o.last=function(){var e,t;return t=this.recordsValues(),e=t[t.length-1],null!=e?e.clone():void 0},o.count=function(){return this.recordsValues().length},o.deleteAll=function(){var e,t,n,o;n=this.records,o=[];for(e in n)t=n[e],o.push(delete this.records[e]);return o},o.destroyAll=function(){var e,t,n,o;n=this.records,o=[];for(e in n)t=n[e],o.push(this.records[e].destroy());return o},o.update=function(e,t,n){return this.find(e).updateAttributes(t,n)},o.create=function(e,t){var n;return n=new this(e),n.save(t)},o.destroy=function(e,t){return this.find(e).destroy(t)},o.change=function(e){return"function"==typeof e?this.bind("change",e):this.trigger("change",e)},o.fetch=function(e){return"function"==typeof e?this.bind("fetch",e):this.trigger("fetch",e)},o.toJSON=function(){return this.recordsValues()},o.fromJSON=function(e){var t,n,o,i;if(e){if("string"==typeof e&&(e=JSON.parse(e)),u(e)){for(i=[],n=0,o=e.length;n<o;n++)t=e[n],i.push(new this(t));return i}return new this(e)}},o.fromForm=function(){var e;return(e=new this).fromForm.apply(e,arguments)},o.recordsValues=function(){var e,t,n,o;t=[],o=this.records;for(e in o)n=o[e],t.push(n);return t},o.cloneArray=function(e){var t,n,o,i;for(i=[],n=0,o=e.length;n<o;n++)t=e[n],i.push(t.clone());return i},o.idCounter=0,o.uid=function(e){var t;return null==e&&(e=""),t=e+this.idCounter++,this.exists(t)&&(t=this.uid(e)),t},o.prototype.isNew=function(){return!this.exists()},o.prototype.isValid=function(){return!this.validate()},o.prototype.validate=function(){},o.prototype.load=function(e){var t,n;for(t in e)n=e[t],"function"==typeof this[t]?this[t](n):this[t]=n;return this},o.prototype.attributes=function(){var e,t,n,o,i;for(t={},i=this.constructor.attributes,n=0,o=i.length;n<o;n++)e=i[n],e in this&&("function"==typeof this[e]?t[e]=this[e]():t[e]=this[e]);return this.id&&(t.id=this.id),t},o.prototype.eql=function(e){return!!(e&&e.constructor===this.constructor&&e.cid===this.cid||e.id&&e.id===this.id)},o.prototype.save=function(e){var t,n;return null==e&&(e={}),e.validate!==!1&&(t=this.validate())?(this.trigger("error",t),!1):(this.trigger("beforeSave",e),n=this.isNew()?this.create(e):this.update(e),this.trigger("save",e),n)},o.prototype.updateAttribute=function(e,t,n){return this[e]=t,this.save(n)},o.prototype.updateAttributes=function(e,t){return this.load(e),this.save(t)},o.prototype.changeID=function(e){var t;return t=this.constructor.records,t[e]=t[this.id],delete t[this.id],this.id=e,this.save()},o.prototype.destroy=function(e){return null==e&&(e={}),this.trigger("beforeDestroy",e),delete this.constructor.records[this.id],delete this.constructor.crecords[this.cid],this.destroyed=!0,this.trigger("destroy",e),this.trigger("change","destroy",e),this.unbind(),this},o.prototype.dup=function(e){var t;return t=new this.constructor(this.attributes()),e===!1?t.cid=this.cid:delete t.id,t},o.prototype.clone=function(){return a(this)},o.prototype.reload=function(){var e;return this.isNew()?this:(e=this.constructor.find(this.id),this.load(e.attributes()),e)},o.prototype.toJSON=function(){return this.attributes()},o.prototype.toString=function(){return"<"+this.constructor.className+" ("+JSON.stringify(this)+")>"},o.prototype.fromForm=function(t){var n,o,i,r,s;for(o={},s=e(t).serializeArray(),i=0,r=s.length;i<r;i++)n=s[i],o[n.name]=n.value;return this.load(o)},o.prototype.exists=function(){return this.id&&this.id in this.constructor.records},o.prototype.update=function(e){var t,n;return this.trigger("beforeUpdate",e),n=this.constructor.records,n[this.id].load(this.attributes()),t=n[this.id].clone(),t.trigger("update",e),t.trigger("change","update",e),t},o.prototype.create=function(e){var t,n;return this.trigger("beforeCreate",e),this.id||(this.id=this.cid),n=this.dup(!1),this.constructor.records[this.id]=n,this.constructor.crecords[this.cid]=n,t=n.clone(),t.trigger("create",e),t.trigger("change","create",e),t},o.prototype.bind=function(e,t){var n,o,i=this;return this.constructor.bind(e,n=function(e){if(e&&i.eql(e))return t.apply(i,arguments)}),this.constructor.bind("unbind",o=function(t){if(t&&i.eql(t))return i.constructor.unbind(e,n),i.constructor.unbind("unbind",o)}),n},o.prototype.one=function(e,t){var n,o=this;return n=this.bind(e,function(){return o.constructor.unbind(e,n),t.apply(o,arguments)})},o.prototype.trigger=function(){var e,t;return e=1<=arguments.length?f.call(arguments,0):[],e.splice(1,0,this),(t=this.constructor).trigger.apply(t,e)},o.prototype.unbind=function(){return this.trigger("unbind")},o}(r),t=function(t){function i(t){this.release=g(this.release,this);var n,o,r;this.options=t,r=this.options;for(n in r)o=r[n],this[n]=o;this.el||(this.el=document.createElement(this.tag)),this.el=e(this.el),this.$el=this.el,this.className&&this.el.addClass(this.className),this.attributes&&this.el.attr(this.attributes),this.events||(this.events=this.constructor.events),this.elements||(this.elements=this.constructor.elements),this.events&&this.delegateEvents(this.events),this.elements&&this.refreshElements(),i.__super__.constructor.apply(this,arguments)}return p(i,t),i.include(n),i.include(o),i.prototype.eventSplitter=/^(\S+)\s*(.*)$/,i.prototype.tag="div",i.prototype.release=function(){return this.trigger("release"),this.el.remove(),this.unbind()},i.prototype.$=function(t){return e(t,this.el)},i.prototype.delegateEvents=function(e){var t,n,o,i,r,s,a=this;s=[];for(n in e){if(i=e[n],"function"==typeof i)i=function(e){return function(){return e.apply(a,arguments),!0}}(i);else{if(!this[i])throw new Error(""+i+" doesn't exist");i=function(e){return function(){return a[e].apply(a,arguments),!0}}(i)}o=n.match(this.eventSplitter),t=o[1],r=o[2],""===r?s.push(this.el.bind(t,i)):s.push(this.el.delegate(r,t,i))}return s},i.prototype.refreshElements=function(){var e,t,n,o;n=this.elements,o=[];for(e in n)t=n[e],o.push(this[t]=this.$(e));return o},i.prototype.delay=function(e,t){return setTimeout(this.proxy(e),t||0)},i.prototype.html=function(e){return this.el.html(e.el||e),this.refreshElements(),this.el},i.prototype.append=function(){var e,t,n;return t=1<=arguments.length?f.call(arguments,0):[],t=function(){var n,o,i;for(i=[],n=0,o=t.length;n<o;n++)e=t[n],i.push(e.el||e);return i}(),(n=this.el).append.apply(n,t),this.refreshElements(),this.el},i.prototype.appendTo=function(e){return this.el.appendTo(e.el||e),this.refreshElements(),this.el},i.prototype.prepend=function(){var e,t,n;return t=1<=arguments.length?f.call(arguments,0):[],t=function(){var n,o,i;for(i=[],n=0,o=t.length;n<o;n++)e=t[n],i.push(e.el||e);return i}(),(n=this.el).prepend.apply(n,t),this.refreshElements(),this.el},i.prototype.replace=function(t){var n,o;return o=[this.el,e(t.el||t)],n=o[0],this.el=o[1],n.replaceWith(this.el),this.delegateEvents(this.events),this.refreshElements(),this.el},i}(r),e=("undefined"!=typeof window&&null!==window?window.jQuery:void 0)||("undefined"!=typeof window&&null!==window?window.Zepto:void 0)||function(e){return e},a=Object.create||function(e){var t;return t=function(){},t.prototype=e,new t},u=function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=function(e){var t;if(!e)return!0;for(t in e)return!1;return!0},c=function(e){return Array.prototype.slice.call(e,0)},s=this.Spine={},"undefined"!=typeof module&&null!==module&&(module.exports=s),s.version="1.0.8",s.isArray=u,s.isBlank=l,s.$=e,s.Events=n,s.Log=o,s.Module=r,s.Controller=t,s.Model=i,r.extend.call(s,n),r.create=r.sub=t.create=t.sub=i.sub=function(e,t){var n;return n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t}(this),e&&n.include(e),t&&n.extend(t),"function"==typeof n.unbind&&n.unbind(),n},i.setup=function(e,t){var n;return null==t&&(t=[]),n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t}(this),n.configure.apply(n,[e].concat(f.call(t))),n},s.Class=r}).call(this),function(){var e=window.NTES||{};e.event||(e.event={}),e.plugin=e.plugin||{},e.event.Mouseenter=function(e,t,n){var o,i=document.createElement("div"),r="onmouseenter"in i,s=e,a="",u=n;switch(s){case"mouseenter":a="mouseover";break;case"mouseleave":a="mouseout";break;default:return null}return s=r?s:a,o=r?t:function(e){var n=e.relatedTarget;for(!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement==e.target?e.toElement:e.fromElement);n&&n!=this;)try{n=n.parentNode}catch(o){n=this}n!=this&&t.call(this,e)},u.addEvent(s,o),{eventName:s,eventHandler:o}}}(),function(e){var t=function(){var t=this;t.selector=".js_N_navSelect",t.unfoldClassName="ntes-nav-select-unfold",t.menus=e(t.selector),t.eventsCache=[],t.init(),t.prevIndex=0},n=!1;t.prototype={constructor:t,init:function(){var t=this;NTES.each(t.menus,function(o,i){var r=e(i),s={},a=NTES.event.Mouseenter("mouseenter",function(i){return e(this),t.timerList&&n?"":void(t.timerList&&t.prevIndex===o?(clearTimeout(t.timerList),t.timerList=void 0):(n=!0,t.timerList=setTimeout(function(){t.unfoldMenu(o),t.timerList=void 0,n=!1},70)))},r),u=NTES.event.Mouseenter("mouseleave",function(o){return e(this),t.timerList&&n?"":void(t.timerList?(clearTimeout(t.timerList),t.timerList=void 0):t.timerList=setTimeout(function(){t.foldMenu(),t.timerList=void 0},70))},r),l=function(n){var o=e(this);o.className.indexOf(t.unfoldClassName)===-1?o.addCss(t.unfoldClassName):o.removeCss(t.unfoldClassName)},c=function(n){switch(e(this),n.keyCode){case 39:t.unfoldMenu(o);break;case 40:t.unfoldMenu(o);break;case 37:t.foldMenu();break;case 38:t.foldMenu();break;case 27:t.foldMenu()}};r.addEvent("click",l).addEvent("keydown",c),s[a.eventName]=a.eventHandler,s[u.eventName]=u.eventHandler,s.click=l,s.keydown=c,t.eventsCache.push(s)})},unfoldMenu:function(t){var n=this;e(n.menus[n.prevIndex]).removeCss(n.unfoldClassName),e(n.menus[t]).addCss(n.unfoldClassName),n.prevIndex=t},foldMenu:function(){var t=this;e(t.menus[t.prevIndex]).removeCss(t.unfoldClassName)},destory:function(e,t){var n=this;if(!e)return void NTES.each(n.menus,function(e,t){var o=n.eventsCache[e];for(var i in o)t.removeEvent(i,o[i])});var o=n._getItem(e),i=o?n.eventsCache[o.index]:null;if(o){for(var r in i)o.item.removeEvent(r,i[r]);t&&t()}},_getItem:function(t){var n=this,o=n.menus,i=0,r=o.length,s=e(t);if(!s)return null;for(s=s.get(0);i<r;i++)if(o[i].get(0)==s)return{item:o[i],index:i};return null}},e.plugin=e.plugin||{},e.plugin.NTESSelectMenu=t}(NTES),function(){var e=this,t=function(){};e.NTESCommonNavigator=e.NTESCommonNavigator||{},e.console=e.console||{log:t,error:t,trace:t,info:t},e.NTESCommonNavigator.namespace=function(){var t,n,o,i,r=arguments,s=null;for(t=0,i=r.length;t<i;t++)for(o=(""+r[t]).split("."),s=e.NTESCommonNavigator,n="NTESCommonNavigator"==o[0]?1:0;n<o.length;n+=1)s[o[n]]=s[o[n]]||{},s=s[o[n]];return s}}.call(this),NTESCommonNavigator.namespace("NTESCommonNavigator.core"),NTESCommonNavigator.core.Constant={Path:{WB_PATH:"http://t.163.com/service/newMessage/",DEFAULT_MAIL_PATH:"http://email.163.com#from=163nav_icon"},Domain:{DOMAIN:["126.com","yeah.net","163.com","188.com","vip.163.com","vip.126.com"],API:["mail.126.com","mail.yeah.net","mail.163.com","mail.188.com","vip.163.com","vip.126.com"]},PRODUCTS:{reg:{name:"\u7528\u6237\u4e2d\u5fc3",url:"http://reg.163.com/Main.jsp?username=pInfo"},"163.com":{name:"\u6211\u7684\u90ae\u7bb1",url:"http://entry.mail.163.com/coremail/fcg/ntesdoor2?verifycookie=1&lightweight=1&df=163navi"},"126.com":{name:"\u6211\u7684\u90ae\u7bb1",url:"http://entry.mail.126.com/cgi/ntesdoor?verifycookie=1&lightweight=1&style=-1&df=163navi"},"vip.126.com":{name:"\u6211\u7684\u90ae\u7bb1",url:"http://reg.vip.126.com/enterMail.m"},"yeah.net":{name:"\u6211\u7684\u90ae\u7bb1",url:"http://entry.yeah.net/cgi/ntesdoor?verifycookie=1&lightweight=1&style=-1&def=163navi"},"188.com":{name:"\u6211\u7684\u90ae\u7bb1",url:"http://reg.mail.188.com/servlet/enter"},"vip.163.com":{name:"\u6211\u7684\u90ae\u7bb1",url:"http://reg.vip.163.com/enterMail.m?enterVip=true-----------"},lofter:{name:"\u6211\u7684LOFTER",url:"http://www.lofter.com/?act=qb163rk_20141031_02"},photo:{name:"\u6211\u7684\u76f8\u518c",url:"http://photo.163.com/?username=pInfo"},yuehui:{name:"\u6211\u7684\u540c\u57ce\u7ea6\u4f1a",url:"http://yuehui.163.com/"},blog:{name:"\u6211\u7684\u535a\u5ba2",url:"http://blog.163.com/passportIn.do?entry=163"},ht:{name:"\u6211\u7684\u82b1\u7530",url:"http://love.163.com?keyfrom=163site.mynavi"},note:{name:"\u6211\u7684\u4e91\u7b14\u8bb0",url:"http://note.youdao.com/web?entry=163.com"},caipiaoyys:{name:"\u6211\u7684\u5f69\u7968",url:"http://caipiao.163.com/#from=www_top_entry"},guijinshu:{name:"\u6211\u7684\u8d35\u91d1\u5c5e",url:"http://fa.163.com/?from=tgnwscj"},cx:{name:"\u6211\u7684\u8f66\u9669",url:"http://baoxian.163.com/car/?from=www_top_entry"},baoxian:{name:"\u6211\u7684\u4fdd\u9669",url:"http://baoxian.163.com/?from=www_top_entry"},shop:{name:"\u7f51\u6613\u5546\u57ce",url:"http://mall.163.com/#from=www_top_entry"},easyread:{name:"\u7f51\u6613\u4e91\u9605\u8bfb",url:"http://yuedu.163.com/#f=topnav"},yunketang:{name:"\u4e91\u8bfe\u5802",url:"http://study.163.com/?utm_source=163.com&utm_medium=web_ursproduct&utm_campaign=business"},kaola:{name:"\u6211\u7684\u8003\u62c9",url:"http://rd.da.netease.com/redirect?t=ZKQJgA&p=IQyfy3&proId=1024&target=http%3A%2F%2Fwww.kaola.com%2F%3Ftag%3Dbe3d8d027a530881037ef01d304eb505"}},DEFAULT_PRODUCTS:["lofter","photo","ht","yuehui","blog","note","caipiaoyys","guijinshu","cx","baoxian","shop","easyread","yunketang","kaola"],LOG_IN_OUT_URL:"http://reg.163.com/Logout.jsp"},NTESCommonNavigator.namespace("NTESCommonNavigator.core"),NTESCommonNavigator.core.Event={Base:{DATA_LOADED:"event_core_data_loaded",DATA_FAILED:"event_core_data_failed",DATA_CHANGED:"event_core_data_changed",LOGIN_SUCCESS:"event_core_login_sucess",LOGIN_FAIL:"event_core_login_fail"},Model:{MAIL_INFO_LOADED:"event_model_mail_info_loaded",LOFTER_INFO_LOADED:"event_model_lofter_info_loaded"}},NTESCommonNavigator.namespace("NTESCommonNavigator.base"),NTESCommonNavigator.base.Class=function(){var e=Spine.Class.create();return Spine.Events,e.include(Spine.Events),e.include({extend:e.extend}),new e},NTESCommonNavigator.namespace("NTESCommonNavigator.base"),NTESCommonNavigator.base.UI=function(){var e=NTESCommonNavigator.base.Class(),t=function(){};return t(),e.extend({}),e},function(){var e={"&":"&amp;","'":"&#39;",'"':"&quot;","<":"&lt;",">":"&gt;"};NTESCommonNavigator.namespace("NTESCommonNavigator.utils"),NTESCommonNavigator.utils.mix={encode:function(t){return t.replace(/[&"'<>]/g,function(t){return e[t]})}}}(),NTESCommonNavigator.namespace("NTESCommonNavigator.utils"),NTESCommonNavigator.utils.Suggestion=function(){function e(){var e=document.getElementById("js_passportUserNameList"),t=o.getXY(i.usernameInputElement).x,n=o.getXY(i.usernameInputElement).y;e.style.left=t+"px",e.style.top=n+i.usernameInputElement.offsetHeight+"px"}function t(e){var t=document.createElement("div");t.innerHTML=e,document.body.appendChild(t.firstChild),t=null}var n=NTESCommonNavigator.base.Class();String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"gm"),t)};var o={getXY:function(e){for(var t=0,n=0;e!=document.body&&null!=e;)n+=e.offsetLeft,t+=e.offsetTop,e=e.offsetParent;return{x:n,y:t}}},i={usernameInputElement:!1,usernameInputElementX:!1,usernameInputElementY:!1,usernameInputHeight:!1,usernameListElement:!1,currentSelectIndex:-1,hasShow:!1,domainSelectElmentString:'<div id = "js_passportUserNameList" class="ntes-domain-selector"  style="display: none;"><div class="ntes-domain-selector-main"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td class="ntes-domain-selector-title">\u8bf7\u9009\u62e9\u6216\u7ee7\u7eed\u8f93\u5165...</td></tr><tr><td><td /></tr></tbody></table></div><iframe src="javascript:\'\';"  style=" z-index:1008;width:100%;height:0px;display:block  " frameborder="0"></iframe></div><div style="display: none;"></div><div id="passport_111"></div>',domainSelectElement:!1,domainArray:["163.com","126.com","yeah.net","vip.163.com","vip.126.com","popo.163.com","188.com","vip.188.com","qq.com","yahoo.com","sina.com"],helpDivString:'<div style="width:100%;" id="passport_helper_div"></div>',resizeFunc:function(){var e=document.getElementById("js_passportUserNameList"),t=o.getXY(i.usernameInputElement).x,n=o.getXY(i.usernameInputElement).y;e.style.left=t+"px",e.style.top=n+i.usernameInputElement.offsetHeight+"px"},bind:function(e){this.usernameInputElement=e;var t=o.getXY(this.usernameInputElement);this.usernameInputElementX=t.x,this.usernameInputElementY=t.y,this.handle()},handle:function(){t(this.domainSelectElmentString),t(this.helpDivString),this.domainSelectElement=document.getElementById("js_passportUserNameList"),this.usernameListElement=this.domainSelectElement.firstChild.firstChild.rows[1].firstChild,this.currentSelectIndex=0,this.usernameInputElement.onblur=function(e){return i.preventEvent(e),setTimeout(function(){i.doSelect()},200),!1};try{this.usernameInputElement.addEventListener("keypress",this.keypressProc,!1),this.usernameInputElement.addEventListener("keyup",this.keyupProc,!1)}catch(n){try{this.usernameInputElement.attachEvent("onkeydown",this.checkKeyDown),this.usernameInputElement.attachEvent("onkeypress",this.keypressProc),this.usernameInputElement.attachEvent("onkeyup",this.keyupProc)}catch(n){}}e(),navigator.userAgent.indexOf("MSIE")>0?window.attachEvent("onresize",e):window.onresize=e},preventEvent:function(e){try{e.cancelBubble=!0,e.returnValue=!1,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()}catch(e){}},checkKeyDown:function(e){this.currentSelectIndex=0;var t=e.keyCode;if(38==t||40==t)return i.preventEvent(e),i.clearFocus(),38==t?i.upSelectIndex():i.downSelectIndex(),i.setFocus(),!1},keyupProc:function(e){this.currentSelectIndex=0;var t=e.keyCode;i.changeUsernameSelect(),13==t&&i.doSelect();var n;return(n=navigator.userAgent.indexOf("Safari"))>0&&(38!=t&&40!=t||(i.preventEvent(e),i.clearFocus(),38==t?i.upSelectIndex():i.downSelectIndex(),i.setFocus())),!1},keypressProc:function(e){this.currentSelectIndex=0;var t=e.keyCode;13==t?i.preventEvent(e):38==t||40==t?(i.preventEvent(e),i.clearFocus(),38==t?i.upSelectIndex():i.downSelectIndex(),i.setFocus()):108!=t&&110!=t&&111!=t&&115!=t||setTimeout(function(){i.changeUsernameSelect()},20)},clearFocus:function(e){var e=this.currentSelectIndex;try{var t=this.findTdElement(e);t.style.backgroundColor="white"}catch(n){}},findTdElement:function(e){try{for(var t=this.usernameListElement.firstChild.rows,n=0;n<t.length;++n)if(t[n].firstChild.idx==e)return t[n].firstChild}catch(o){}return!1},upSelectIndex:function(){var e=this.currentSelectIndex;if(null!=this.usernameListElement.firstChild){var t,n=this.usernameListElement.firstChild.rows;for(t=0;t<n.length&&n[t].firstChild.idx!=e;++t);0==t?this.currentSelectIndex=n.length-1:this.currentSelectIndex=n[t-1].firstChild.idx}},downSelectIndex:function(){var e=this.currentSelectIndex;if(null!=this.usernameListElement.firstChild){for(var t=this.usernameListElement.firstChild.rows,n=0;n<t.length&&t[n].firstChild.idx!=e;++n);n>=t.length-1?this.currentSelectIndex=t[0].firstChild.idx:this.currentSelectIndex=t[n+1].firstChild.idx}},setFocus:function(){var e=this.currentSelectIndex;try{var t=this.findTdElement(e);t.style.backgroundColor="#D5F1FF"}catch(n){}},changeUsernameSelect:function(){var t=this.usernameInputElement.value;if(t=t.replaceAll("<",""),""==t.trim())this.domainSelectElement.style.display="none",this.hasShow=!1;else{var n,o="",r="";(n=t.indexOf("@"))<0?(o=t,r=""):(o=t.substr(0,n),r=t.substr(n+1,t.length));var s=[];if(""==r)for(var a=0;a<this.domainArray.length;++a)s.push(o+"@"+this.domainArray[a]);else for(var a=0;a<this.domainArray.length;++a)0==this.domainArray[a].indexOf(r)&&s.push(o+"@"+this.domainArray[a]);if(s.length>0){e(),this.domainSelectElement.style.display="block",this.hasShow=!0;var u=document.createElement("TABLE");u.cellSpacing=0,u.cellPadding=3;var l=document.createElement("TBODY");u.appendChild(l);for(var a=0;a<s.length;++a){var c=document.createElement("TR"),d=document.createElement("TD");d.nowrap="true",d.align="left",d.innerHTML=s[a],d.idx=a,d.onmouseover=function(){i.clearFocus(),i.currentSelectIndex=this.idx,i.setFocus(),this.style.cursor="hand"},d.onmouseout=function(){},d.onclick=function(e){return i.doSelect(),i.preventEvent(e),!1},c.appendChild(d),l.appendChild(c)}this.usernameListElement.innerHTML="",this.usernameListElement.appendChild(u);for(var f=0,m=0;m<s.length;++m)s[m].length>f&&(f=s[m].length);f=10*f,f<185&&(f=185),u.style.width=f+"px",this.domainSelectElement.style.width=u.style.width,this.setFocus()}else this.domainSelectElement.style.display="none",this.hasShow=!1,this.currentSelectIndex=-1}},doSelect:function(){if(this.domainSelectElement.style.display="none",this.hasShow=!1,""!=this.usernameInputElement.value.trim()){var e=this.findTdElement(this.currentSelectIndex);e&&(this.usernameInputElement.value=e.innerHTML,this.usernameInputElement.value=this.usernameInputElement.value.replaceAll("<",""))}}};return n.extend({getInstance:function(){return i}}),n},NTESCommonNavigator.namespace("NTESCommonNavigator.utils"),NTESCommonNavigator.utils.Login=function(){var e=NTESCommonNavigator.base.Class(),t=NTESCommonNavigator.core.Event.Base;try{document.domain="163.com"}catch(n){}var o=NTESCommonNavigator.utils.Suggestion().getInstance(),i={listenFrame:!0,loginAction:"https://reg.163.com/logins.jsp",loginRedirect:"http://reg.163.com/redirect.jsp",successAction:"",failedAction:"",success:{},failed:{},errorMsg:{412:"\u60a8\u5c1d\u8bd5\u7684\u6b21\u6570\u5df2\u7ecf\u592a\u591a,\u8bf7\u8fc7\u4e00\u6bb5\u65f6\u95f4\u518d\u8bd5",414:"\u60a8\u7684IP\u767b\u5f55\u5931\u8d25\u6b21\u6570\u8fc7\u591a,\u8bf7\u7a0d\u540e\u518d\u8bd5",415:"\u60a8\u4eca\u5929\u767b\u5f55\u9519\u8bef\u6b21\u6570\u5df2\u7ecf\u592a\u591a,\u8bf7\u660e\u5929\u518d\u8bd5",416:"\u60a8\u7684IP\u4eca\u5929\u767b\u5f55\u8fc7\u4e8e\u9891\u7e41\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",417:"\u60a8\u7684IP\u4eca\u5929\u767b\u5f55\u6b21\u6570\u8fc7\u591a\uff0c\u8bf7\u660e\u5929\u518d\u8bd5",418:"\u60a8\u4eca\u5929\u767b\u5f55\u6b21\u6570\u8fc7\u591a,\u8bf7\u660e\u5929\u518d\u8bd5",419:"\u60a8\u7684\u767b\u5f55\u64cd\u4f5c\u8fc7\u4e8e\u9891\u7e41\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5",420:"\u7528\u6237\u540d\u4e0d\u5b58\u5728",422:"\u5e10\u53f7\u88ab\u9501\u5b9a\uff0c\u8bf7\u60a8\u89e3\u9501\u540e\u518d\u767b\u5f55",424:"\u8be5\u9753\u53f7\u670d\u52a1\u5df2\u5230\u671f\uff0c\u8bf7\u60a8\u7eed\u8d39",425:"\u5916\u57df\u5e10\u53f7\u5e76\u4e14\u5728\u6fc0\u6d3b\u6709\u6548\u671f\u4ee5\u5185",426:"\u5916\u57df\u5e10\u53f7\u5e76\u4e14\u5df2\u7ecf\u8fc7\u4e86\u6fc0\u6d3b\u6709\u6548\u671f\u9650",427:"\u8d85\u65f6\uff0c\u5df2\u8d85\u8fc75\u5206\u949f\u6709\u6548\u671f",428:"\u9700\u8981\u8fdb\u5165\u4e2d\u95f4\u63d0\u9192\u9875\u9762",460:"\u5bc6\u7801\u4e0d\u6b63\u786e",500:"\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u60a8\u7a0d\u540e\u518d\u8bd5",503:"\u7cfb\u7edf\u7ef4\u62a4\uff0c\u8bf7\u60a8\u7a0d\u540e\u518d\u8bd5",1e3:"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u7528\u6237\u540d"},commit:function(e){e&&(!this.frame&&this.createElements(),this.username.value=e.username,this.password.value=e.password,this.type.value=e.type,this.product.value=e.product,this.savelogin.value=e.savelogin,this.url.value=this.successAction,this.url2.value=this.failedAction,this.noRedirect.value=1,this.form.submit())},verifyLogin:function(){if(this.verifyCookie&&this.verifyCookie())for(var e in this.success)"function"==typeof this.success[e]&&this.success[e].call(this,arguments[0]);else for(var e in this.failed)"function"==typeof this.failed[e]&&(arguments[0]&&(arguments[0].errorMsg=this.errorMsg[this.errorMsg[arguments[0].errorType]?arguments[0].errorType:1e3]),this.failed[e].call(this,arguments[0]))},getSearches:function(e){e=e||window.location.search;for(var t=e.substring(1),n=t.split("&"),o={},i=0;i<n.length;i++){var r=n[i].split("=");r[0]&&(o[r[0]]=r[1]||null)}return o},createElements:function(){this.frame=this.createFrame(),this.form=this.createForm(),this.username=this.createInput("username"),this.password=this.createInput("password"),this.type=this.createInput("type"),this.product=this.createInput("product"),this.savelogin=this.createInput("savelogin"),this.url=this.createInput("url"),this.url2=this.createInput("url2"),this.noRedirect=this.createInput("noRedirect"),this.form.appendChild(this.username),this.form.appendChild(this.password),this.form.appendChild(this.type),this.form.appendChild(this.product),this.form.appendChild(this.savelogin),this.form.appendChild(this.url),this.form.appendChild(this.url2),this.form.appendChild(this.noRedirect),document.body.appendChild(this.form),document.body.appendChild(this.frame)},createInput:function(e){var t=this.toElement("<input/>");return t.setAttribute("name",e),t},toElement:function(){var e=document.createElement("div");return function(t){e.innerHTML=t;var n=e.firstChild;return e.removeChild(n),n}}(),createFrame:function(){var e,t=this,n="login_util_frame",o=0;return e=t.toElement('<iframe src="javascript:false;" name="'+n+'" />'),e.setAttribute("id",n),e.setAttribute("border","no"),e.style.display="none",e.onload=e.onreadystatechange=function(){t.listenFrame&&(this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||((o||this.contentWindow.location.search)&&t.verifyLogin(t.getSearches(this.contentWindow.location.search)),o++))},e},createForm:function(){var e,t=this;return e=t.toElement('<form method="post"></form>'),e.setAttribute("id","login_util_form"),e.setAttribute("action",this.loginAction),e.setAttribute("target",this.frame.name),e.style.display="none",e}};i.verifyCookie=function(){var e=NTES.cookie.get("S_INFO"),t=NTES.cookie.get("P_INFO");return e&&"2"!=t[2]},i.successAction="http://www.163.com/special/0077450P/login_frame.html",i.failedAction="http://www.163.com/special/0077450P/login_frame.html",i.success.userProduct=function(e){r.loginSuccess(e)},i.failed.userProduct=function(e){r.loginFailed(e)};var r={logined:!1,mailReg:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,trimReg:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,formEl:NTES("#js_N_login_wrap"),fieldEl:NTES("#js_N_login_wrap input"),submitEl:NTES("#js_N_login_wrap .ntes-loginframe-btn"),tipEl:NTES("#js_N_login_wrap .ntes-loginframe-tips"),nameTmp:"",passTmp:"",passportLoaded:!1};return r.nameField=r.fieldEl[0],r.passField=r.fieldEl[1],r.saveField=r.fieldEl[2],r.tipText=r.tipEl[0].innerHTML,r.passField.type="password",o.bind(r.nameField),r.filter={"163.com":{read:1,name:"163",url:"http://entry.mail.163.com/coremail/fcg/ntesdoor2?verifycookie=1&lightweight=1"},"126.com":{read:1,name:"126",url:"http://entry.mail.126.com/cgi/ntesdoor?verifycookie=1&lightweight=1&style=-1"},"yeah.net":{read:1,name:"yeah",url:"http://entry.yeah.net/cgi/ntesdoor?verifycookie=1&lightweight=1&style=-1"},"188.com":{read:0,name:"188",url:"http://reg.mail.188.com/servlet/enter"},"vip.126.com":{read:0,name:"vip",url:"http://reg.vip.126.com/enterMail.m"},"vip.163.com":{read:0,name:"vip",url:"http://reg.vip.163.com/enterMail.m?enterVip=true-----------"}},r.trim=function(e){return e?(e+"").replace(r.trimReg,""):""},r.verifyFields=function(e,t){var n=r.nameField,o=r.passField;return 0==e.length?(r.addClass(n.parentNode,"tips-error"),this.loginFailed(),n.focus(),!1):0!=t.length||(r.addClass(o.parentNode,"tips-error"),o.focus(),this.loginFailed(),!1)},r.submit=function(){var e,t=r.trim(r.nameField.value),n=r.passField.value,o=r.saveField.checked?1:0;r.nameTmp=t,r.passTmp=n,r.verifyFields(t,n)&&(e={username:t,password:n,savelogin:o,product:"163",type:1},i.commit(e))},r.loginSuccess=function(n){r.logined=!0,e.trigger(t.LOGIN_SUCCESS)},r.loginFailed=function(n){if(r.logined=!1,e.trigger(t.LOGIN_FAIL),r.showError(n&&n.errorMsg?n.errorMsg:r.tipText),n)switch(parseInt(n.errorType)){case 420:setTimeout(function(){r.nameField.focus()},1e3);break;case 428:window.open(n.url?[unescape(n.url),"url="+location.href].join("&"):i.loginRedirect,"_self");
break;case 460:setTimeout(function(){r.passField.focus()},1e3)}},r.showError=function(e){r.tipEl[0].innerHTML=e},r.hasClass=function(e,t){var n="*"+e.className.replace(/\s+/gi,"*")+"*";return n.indexOf("*"+t+"*")!=-1},r.addClass=function(e,t){if(!r.hasClass(e,t)){var n=e.className+" "+t;e.className=r.trim(n)}},r.removeClass=function(e,t){if(r.hasClass(e,t)){var n="*"+e.className.replace(/\s+/gi,"*")+"*";n=n.replace(new RegExp("\\*"+t+"\\*","ig")," ").replace(/\*/gi," "),e.className=r.trim(n)}},r.submitEl.addEvent("click",function(){r.submit()}),r.formEl.addEvent("keydown",function(e){if(13==e.keyCode&&!i.verifyCookie()){if(o.hasShow)return void setTimeout(function(){r.passField.focus()},250);r.submit()}}),NTES.event.addEvent(r.fieldEl,"keyup",function(){var e=r.trim(r.nameField.value),t=r.passField.value;r.nameTmp==e&&r.passTmp==t||(r.removeClass(this.parentNode,"tips-error"),r.showError(r.tipText))}),e.extend({}),e},NTESCommonNavigator.namespace("NTESCommonNavigator.utils"),NTESCommonNavigator.utils.ChangeCookie=function(){var e=NTESCommonNavigator.base.Class(),t=document.createElement("div"),n="",o="163",i="",r="http://reg.163.com/chgcookie.jsp?",s="http://www.163.com/special/0077450P/login_frame.html",a='<iframe src="javascript:false;" name="changeCookie" frameborder="0" style="width:0;height:0;display:none;"></iframe>',u=function(e){try{document.body.removeChild(e)}catch(t){}},l=function(e){var l=null;t.innerHTML=a,i=NTES.cookie.get("USERTRACK"),n=String(NTES.cookie.get("P_INFO")).split("|")[0],document.body.appendChild(l=t.firstChild),l.onload=l.onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||setTimeout(function(){NTES.cookie.get("S_INFO")&&e&&e(),u(l),l=null},400)},l.src=r+["username="+n,"product="+o,"userip="+i,"retUrl="+s,"loginUrl="+s].join("&")};return e.extend({invoke:function(e){NTES.ready(function(){l(e)})}}),e},NTESCommonNavigator.namespace("NTESCommonNavigator.data"),NTESCommonNavigator.data.UserInfo=function(){var e=NTESCommonNavigator.base.Class(),t=NTESCommonNavigator.utils.mix,n=NTESCommonNavigator.core.Event.Base,o=null,i=null,r=NTES,s="",a="",u=s,l=function(){c()},c=function(){o=Spine.Model.setup("UserInfo",["userName","userMail","userDomain","userIp","userLogin","userProduct"]),o.include({validate:function(){}}),i=o.create()},d=function(){var o=[],l=[],c="";s=String(r.cookie.get("P_INFO")),a=String(r.cookie.get("S_INFO")),o=s.split("|"),l=a.split("|"),c=o[0]||"",i=i.load({userName:t.encode(c.split("@")[0]),userMail:t.encode(c),userDomain:t.encode(c?c.split("@")[1]||"":""),userIp:t.encode(r.cookie.get("USERTRACK")||""),userLogin:!(!c||!a&&1!=o[2]),userProduct:t.encode(o[7]||"")}).save(),s==u&&s||"null"===a||(e.trigger(n.DATA_CHANGED,i),u=s)},f=function(){return i},m=function(){return s},h=function(){return a};return l(),e.extend({refresh:function(){return d(),e},getUserInfo:function(){return f()},getPInfo:function(){return m()},getSInfo:function(){return h()}}),e},NTESCommonNavigator.namespace("NTESCommonNavigator.data"),NTESCommonNavigator.data.MailInfo=function(){var e=NTESCommonNavigator.base.Class(),t=NTESCommonNavigator.core.Constant,n=t.Domain.DOMAIN,o=t.Domain.API,i=NTESCommonNavigator.core.Event.Base,r="http://msg.",s="/cgi/mc?funcid=getusrnewmsgcnt&fid=1&addSubFdrs=1&language=0&style=0&template=newmsgres_setcookie.htm&df=www163&callback=fAccountCountCall&username=",a="",u="",l=null,c=null,d=function(){f()},f=function(){l=Spine.Model.setup("MailInfo",["newCount","totalCount","userName"]),l.include({validate:function(){}}),c=l.create(),m({})},m=function(e){var t=parseInt(e.newCount)||0,n=parseInt(e.totalCount)||0;c=c.load({newCount:t,totalCount:n,userName:e.userName||""}).save()},h=function(t,l){t&&p(t),l&&g(l);for(var d=0;d<n.length;d++)if(a===n[d]){NTES.ajax.importJs(r+o[d]+s+u),window.fAccountCountCall=function(t,n,o){m({newCount:t,totalCount:n,userName:o}),e.trigger(i.DATA_LOADED,c)};break}},p=function(e){e&&(u=e)},g=function(e){e&&(a=e)},v=function(){return c};return d(),e.extend({refresh:function(e,t){h(e,t)},getMailInfo:function(){return v()},setUserMail:function(e){p(e)},setUserDomain:function(e){g(e)}}),e},NTESCommonNavigator.namespace("NTESCommonNavigator.data"),NTESCommonNavigator.data.LofterInfo=function(){var e=NTESCommonNavigator.base.Class(),t=(NTESCommonNavigator.core.Constant,NTESCommonNavigator.core.Event.Base),n=null,o=null,i="",r="",s=function(){a()},a=function(){n=Spine.Model.setup("LofterInfo",["count"]),n.include({validate:function(){}}),o=n.create(),u({})},u=function(e){e=parseInt(e)||0,o=o.load({count:e}).save()},l=function(n){n&&c(n),i="http://www.lofter.com/newNotice.do?email="+r+"&from=163top&callback=lofterInfoCallback",NTES.ajax.importJs(i,function(){"undefined"!=typeof window.lofterInfoCount&&(u(window.lofterInfoCount),e.trigger(t.DATA_LOADED,o))},"UTF-8")},c=function(e){if("string"==typeof e)return void(r=e);throw"invalid arguments for setUsermail"},d=function(){return r};return getLofterInfo=function(){return o},window.lofterInfoCallback=function(e){window.lofterInfoCount=e},s(),e.extend({refresh:function(e){l(e)},setUserMail:function(e){e&&c(e)},getUserMail:function(){return d()},getLofterInfo:function(){return getLofterInfo()}}),e},NTESCommonNavigator.namespace("NTESCommonNavigator.ui"),NTESCommonNavigator.ui.NavBar=function(){var e=NTESCommonNavigator.base.UI(),t=NTES,n=NTESCommonNavigator.utils.mix,o=".ntes-nav-msg-num",i=t("#js_N_navHighlight"),r=t("#js_N_navLoginBefore"),s=t("#js_N_NavLoginAfter"),a=t("#js_N_navUsername"),u=t("#js_N_navLogout"),l=t("#js_N_logined_warp"),c=t("#js_logined_suggest"),d=t("#js_login_suggest_wrap"),f=(t("#js_N_navHighlight"),t("#js_mail_url")),m=t("#js_N_navMailMsg"),h=t("#js_N_navLofterMsg"),p=t("#js_lofter_icon_url"),g=t("#js_N_navBoboMsg"),v=document.getElementById("js_lofter_pop_url").getElementsByTagName("a");return huatianMsg=t("#js_N_navHuatianMsg"),cookieNavHuatianShow="n_ht_s",huatianNavShow=!1,Constant=NTESCommonNavigator.core.Constant,products=Constant.PRODUCTS,defaultProducts=Constant.DEFAULT_PRODUCTS,loginOutUrl=Constant.LOG_IN_OUT_URL,selectMenu=null,userInfo=null,mailInfo=null,lofterInfo=null,init=function(){bindEvent(),selectMenu=new NTES.plugin.NTESSelectMenu},bindEvent=function(){var e=!1;window.addEvent("scroll",function(){document.documentElement.scrollTop+document.body.scrollTop>0?e||(i.addCss("ntes-nav-login-scroll"),l.addCss("ntes-nav-logined-scroll"),e=!0):e&&(i.removeCss("ntes-nav-login-scroll"),l.removeCss("ntes-nav-logined-scroll"),e=!1)}),t(m.parentNode).addEvent("click",function(){m.style.display="none"}),t(h.parentNode).addEvent("click",function(){h.style.display="none"}),t(huatianMsg.parentNode).addEvent("click",function(){huatianMsg.style.display="none",huatianNavShow&&NTES.cookie.set(cookieNavHuatianShow,0,"1d","163.com","/")})},login=function(e){if(userInfo=e,!userInfo)return void logout();var t=userInfo.userName,o=userInfo.userDomain,i=userInfo.userMail,l=/&df=163navi/i,c=products[o]?products[o].url:Constant.Path.DEFAULT_MAIL_PATH;c=c.replace(l,"&df=163nav_icon"),a.innerHTML=t.length<12?i:t.substr(0,12)+"...@"+o,u.href=loginOutUrl+"?url="+n.encode(location.href),f.href=c,p.href+="&logined=true";for(var d=0,m=v.length;d<m;d++)v[d].href+="&logined=true";setLoginSuggest(userInfo.userProduct),r.style.display="none",s.style.display="block";var h=NTES.cookie.get(cookieNavHuatianShow);h?parseInt(h)?setHuatianInfo(!0):setHuatianInfo(!1):Math.random()<=.5&&(NTES.cookie.set(cookieNavHuatianShow,1,"1d","163.com","/"),setHuatianInfo(!0)),g&&setBoBoInfo(!0)},setLoginSuggest=function(e){for(var t=e?~e.indexOf(",")?e.split(","):e.split("&"):[],o=0,i=t.length>defaultProducts.length?defaultProducts.length:t.length,r="",s=["reg"],a=[];o<i;o++)r=t[o],!!products[r]&&s.push(r);for(1==s.length&&(s=s.concat(defaultProducts)),~Constant.Domain.DOMAIN.indexOf(userInfo.userDomain)&&s.splice(1,0,userInfo.userDomain);s.length;)r=s[0],a.push((1==s.length?"<li class='last'>":"<li>")+"<a href='"+products[r].url+"'><span>\u8fdb\u5165"+products[r].name+"</span></a></li>"),s.shift();c.innerHTML=a.join("").replace(/pInfo/g,n.encode(userInfo.userMail))},logout=function(){a.innerHTML="",c.innerHTML="",f.href=Constant.Path.DEFAULT_MAIL_PATH,u.href="javascript: void(0)",r.style.display="block",s.style.display="none",p.href=p.href.replace("&logined=true","");for(var e=0,t=v.length;e<t;e++)v[e].href=v[e].href.replace("&logined=true","");userInfo=null,setMailInfo(null),setLofterInfo(null),setHuatianInfo(null),setBoBoInfo(null)},setMsg=function(e,n,i){var r=t(o,e).get(0);i||(n>99&&(n="99+"),n<0&&(n=0)),r&&e&&(n?(r.innerHTML=n,e.style.display="block"):(r.innerHTML="",e.style.display="none"))},setHuatianInfo=function(e){huatianNavShow=e,setMsg(huatianMsg,e?"N":"",!0)},setLofterInfo=function(e){setMsg(h,e?e.count:0),e&&e.count>0?p.href=p.href.replace("qb163sydl_20140917_01","qb163sydl_20140917_02"):p.href=p.href.replace("qb163sydl_20140917_02","qb163sydl_20140917_01"),lofterInfo=e},setBoBoInfo=function(e){setMsg(g,e?"N":"",!0)},setMailInfo=function(e){setMsg(m,e?e.newCount:0),mailInfo=e},unFoldUserCenter=function(){d.style.display="block",setTimeout(function(){d.style.display=""},4e3)},init(),e.extend({login:function(e){login(e)},logout:function(){logout()},setLofterInfo:function(e){setLofterInfo(e)},setMailInfo:function(e){setMailInfo(e)},setHuatianInfo:function(e){setHuatianInfo(e)},setBoBoInfo:function(e){setBoBoInfo(e)},unFoldUserCenter:function(){unFoldUserCenter()}}),e},NTESCommonNavigator.namespace("NTESCommonNavigator.ui"),NTESCommonNavigator.ui.Login=function(){var e=NTESCommonNavigator.base.UI(),t=NTES,n=t("#js_N_navHighlight"),o=(t("#js_loginframe_username"),t.util),i=(o.extend,1e3),r=t("#js_passportUserNameList"),s=t("#js_N_navHighlight .ntes-nav-login-title"),a=t("#js_N_navHighlight .ntes-nav-loginframe-pop"),u=!1,l=t(document.body),c=null,d=!1;return animateType={shake:"ue-shake"},currentAnimateType="",init=function(){u=isElmHasShow(a),n.addCss("ntes-nav-login-normal"),s.addEvent("click",onShowLoginClick),s.addEvent("mouseover",onShowLoginBtnMouseover),s.addEvent("mouseout",onShowLoginBtnMouseout),a.addEvent("mouseover",onShowloginPopMouseover),l.addEvent("click",onBodyClick),window.addEvent("scroll",onBodyScroll),r=r?r.get(0):null},isElmHasShow=function(e){return"none"!=t.style.getCurrentStyle(e,"display")},onShowLoginClick=function(e){return isElmHasShow(a)?hidePop():showPop(),!1},clearTimer=function(){c&&(clearTimeout(c),c=null)},setTimer=function(e){c=setTimeout(function(){e&&e()},i)},onShowLoginBtnMouseover=function(e){clearTimer(),showPop()},onShowLoginBtnMouseout=function(e){clearTimer(),setTimer(function(){hidePop()})},onShowloginPopMouseover=function(e){clearTimer()},onBodyClick=function(e){if(u){for(var t=e.target||e.srcElement,n=a.get(0),o=s.get(0);t;){if(t==n||t==o||t==r)return;t=t.parentNode}return hidePop(),!1}},onBodyScroll=function(e){u&&hidePop()},success=function(e){hidePop()},fail=function(e){animatePop("shake")},hidePop=function(){a.get(0).style.display="none",u=!1,n.addCss("ntes-nav-login-normal"),n.removeCss("ntes-nav-login-active"),a.removeCss("ue-animation"),currentAnimateType&&a.removeCss(currentAnimateType)},showPop=function(){d||(new URS(window.login_config),d=!0),a.get(0).style.display="block",u=!0,n.addCss("ntes-nav-login-active"),n.removeCss("ntes-nav-login-normal"),a.addCss("ue-animation")},animatePop=function(e){var t=animateType[e]||"";currentAnimateType&&a.removeCss(currentAnimateType),t&&a.addCss(t),currentAnimateType=t,currentAnimateType&&setTimeout(function(){a.removeCss(currentAnimateType)},1e3)},setUserName=function(e){},init(),e.extend({show:function(){showPop()},hide:function(){hidePop()},success:function(){success()},fail:function(){fail()},setUserName:function(e){setUserName(e)}}),e},NTESCommonNavigator.namespace("NTESCommonNavigator.core"),NTESCommonNavigator.core.Model=function(){var e=NTESCommonNavigator.base.Class(),t=NTESCommonNavigator.core.Event.Base,n=NTESCommonNavigator.core.Event.Model,o=NTESCommonNavigator.data.UserInfo(),i=NTESCommonNavigator.data.MailInfo(),r=NTESCommonNavigator.data.LofterInfo(),s=NTESCommonNavigator.utils.ChangeCookie(),a=function(){i.bind(t.DATA_LOADED,c),r.bind(t.DATA_LOADED,d),o.bind(t.DATA_CHANGED,l)},u=function(){var e=o.getUserInfo();i.refresh(e.userName,e.userDomain),r.refresh(e.userMail)},l=function(n){n.userLogin&&(o.getSInfo()?u():s.invoke(function(){u()})),e.trigger(t.DATA_CHANGED,n)},c=function(t){e.trigger(n.MAIL_INFO_LOADED,t)},d=function(t){e.trigger(n.LOFTER_INFO_LOADED,t)},f=function(){return o.getUserInfo()};return a(),e.extend({refresh:function(){o.refresh()},getUserInfo:function(){return f()}}),e},NTESCommonNavigator.namespace("NTESCommonNavigator.core"),NTESCommonNavigator.core.View=function(e){var t=NTESCommonNavigator.base.Class(),n=NTESCommonNavigator.ui.NavBar(),o=NTESCommonNavigator.ui.Login(),i=NTESCommonNavigator.core.Event.Model,r=NTESCommonNavigator.core.Event.Base,s=function(){e.bind(i.MAIL_INFO_LOADED,a),e.bind(i.LOFTER_INFO_LOADED,u),e.bind(r.DATA_CHANGED,l)},a=function(e){n.setMailInfo(e)},u=function(e){n.setLofterInfo(e)},l=function(e){e.userLogin?n.login(e):n.logout()},c=function(){o.success(),n.unFoldUserCenter()},d=function(){o.fail()};return s(),t.extend({loginSuccess:function(){c()},loginFail:function(){d()}}),t},NTESCommonNavigator.namespace("NTESCommonNavigator.core"),NTESCommonNavigator.core.Controller=function(){var e=NTESCommonNavigator.base.Class(),t=NTESCommonNavigator.core.Model(),n=NTESCommonNavigator.core.View(t),o=NTESCommonNavigator.core.Event.Base,i=NTESCommonNavigator.core.Event.Model,r=function(){t.bind(o.DATA_CHANGED,u),t.bind(i.MAIL_INFO_LOADED,s),t.bind(i.LOFTER_INFO_LOADED,a)},s=function(t){e.trigger(i.MAIL_INFO_LOADED,t)},a=function(t){e.trigger(i.LOFTER_INFO_LOADED,t)},u=function(t){e.trigger(o.DATA_CHANGED,t)},l=function(){t.refresh(),n.loginSuccess()};return window.login_config={product:"163",promark:"MODXOXd",host:"www.163.com",isHttps:1,includeBox:"urs-login-block",page:"login",placeholder:{account:"\u7f51\u6613\u90ae\u7bb1/\u5e38\u7528\u90ae\u7bb1",pwd:"\u8bf7\u8f93\u5165\u5bc6\u7801"},needUnLogin:1,defaultUnLogin:0,needPrepare:1,single:1,regUrl:"http://reg.163.com/reg/reg.jsp?product=urs",cssDomain:"http://temp.163.com/special/00804C4H/",cssFiles:"urs_style.css?13",frameSize:{width:260,height:214},autoSuffix:1,logincb:function(e){l()},regcb:function(e){}},r(),e.extend({refresh:function(){t.refresh()},getUserInfo:function(){return t.getUserInfo()}}),e},function(){var e={platform:""},t={detect:function(){if(navigator.platform.indexOf("Win")>-1)e.platform="ua-win";else if(navigator.platform.indexOf("Mac")>-1)e.platform="ua-mac";else{if(!(navigator.platform.indexOf("iPad")>-1||navigator.platform.indexOf("iPhone")>-1))return!1;e.platform="ua-ios"}},init:function(){this.detect(),e.platform&&NTES("html").addCss(e.platform)}};t.init()}(),NTES.ready(function(){var e=(NTES,NTESCommonNavigator.core.Controller),t=NTESCommonNavigator.core.Event.Base,n=NTESCommonNavigator.core.Event.Model,o=NTESCommonNavigator.utils.app=e();o.bind(t.DATA_CHANGED,function(e){}),o.bind(n.MAIL_INFO_LOADED,function(e){}),o.bind(n.LOFTER_INFO_LOADED,function(e){}),o.refresh()});
